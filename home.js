// Chung
function fungsiSearch(){var a=document.getElementById("Query-input");a.classList.toggle("mystyle")}function myMenu(){var a=document.getElementById("PageList1");a.classList.toggle("shwx")};
function darkMode(){localStorage.setItem("mode","darkmode"===localStorage.getItem("mode")?"light":"darkmode"),"darkmode"===localStorage.getItem("mode")?document.querySelector("#modeSwitch").classList.add("dark-mode"):document.querySelector("#modeSwitch").classList.remove("dark-mode");location.reload();};
var mybutton=document.getElementById("scTop");window.onscroll=function(){scrollFunction()};function scrollFunction(){if(document.body.scrollTop>150||document.documentElement.scrollTop>150){mybutton.style.display="block"}else{mybutton.style.display="none"}}function topFunction(){document.body.scrollTop=0;document.documentElement.scrollTop=0};
// Prefetch
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.quicklink={})}(this,function(e){function n(e){return new Promise(function(n,t,r){(r=new XMLHttpRequest).open("GET",e,r.withCredentials=!0),r.onload=function(){200===r.status?n():t()},r.send()})}var t,r=(t=document.createElement("link")).relList&&t.relList.supports&&t.relList.supports("prefetch")?function(e){return new Promise(function(n,t,r){(r=document.createElement("link")).rel="prefetch",r.href=e,r.onload=n,r.onerror=t,document.head.appendChild(r)})}:n,o=window.requestIdleCallback||function(e){var n=Date.now();return setTimeout(function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-n))}})},1)},i=new Set;function c(e,t,o){if(o=navigator.connection){if(o.saveData)return Promise.reject(new Error("Cannot prefetch, Save-Data is enabled"));if(/2g/.test(o.effectiveType))return Promise.reject(new Error("Cannot prefetch, network conditions are poor"))}return Promise.all([].concat(e).map(function(e){if(!i.has(e))return i.add(e),(t?function(e){return window.fetch?fetch(e,{credentials:"include"}):n(e)}:r)(new URL(e,location.href).toString())}))}e.listen=function(e){if(e||(e={}),window.IntersectionObserver){var n=function(e){e=e||1;var n=[],t=0;function r(){t<e&&n.length>0&&(n.shift()(),t++)}return[function(e){n.push(e)>1||r()},function(){t--,r()}]}(e.throttle||1/0),t=n[0],r=n[1],f=e.limit||1/0,u=e.origins||[location.hostname],s=e.ignores||[],a=e.delay||0,l=[],h=e.timeoutFn||o,d="function"==typeof e.hrefFn&&e.hrefFn,m=new IntersectionObserver(function(n){n.forEach(function(n){if(n.isIntersecting)l.push((n=n.target).href),function(e,n){n?setTimeout(e,n):e()}(function(){-1!==l.indexOf(n.href)&&(m.unobserve(n),i.size<f&&t(function(){c(d?d(n):n.href,e.priority).then(r).catch(function(n){r(),e.onError&&e.onError(n)})}))},a);else{var o=l.indexOf((n=n.target).href);o>-1&&l.splice(o)}})},{threshold:e.threshold||0});return h(function(){(e.el||document).querySelectorAll("a").forEach(function(e){u.length&&!u.includes(e.hostname)||function e(n,t){return Array.isArray(t)?t.some(function(t){return e(n,t)}):(t.test||t).call(t,n.href,n)}(e,s)||m.observe(e)})},{timeout:e.timeout||2e3}),function(){i.clear(),m.disconnect()}}},e.prefetch=c});window.addEventListener('load',function(){quicklink.listen()});
// Lazysize 5.3.2
window.addEventListener('DOMContentLoaded',function(){!function(e){var t=function(u,D,f){"use strict";var k,H;if(function(){var e;var t={lazyClass:"lazyload",loadedClass:"lazyloaded",loadingClass:"lazyloading",preloadClass:"lazypreload",errorClass:"lazyerror",autosizesClass:"lazyautosizes",fastLoadedClass:"ls-is-cached",iframeLoadMode:0,srcAttr:"data-src",srcsetAttr:"data-srcset",sizesAttr:"data-sizes",minSize:40,customMedia:{},init:true,expFactor:1.5,hFac:.8,loadMode:2,loadHidden:true,ricTimeout:0,throttleDelay:125};H=u.lazySizesConfig||u.lazysizesConfig||{};for(e in t){if(!(e in H)){H[e]=t[e]}}}(),!D||!D.getElementsByClassName){return{init:function(){},cfg:H,noSupport:true}}var O=D.documentElement,i=u.HTMLPictureElement,P="addEventListener",$="getAttribute",q=u[P].bind(u),I=u.setTimeout,U=u.requestAnimationFrame||I,o=u.requestIdleCallback,j=/^picture$/i,r=["load","error","lazyincluded","_lazyloaded"],a={},G=Array.prototype.forEach,J=function(e,t){if(!a[t]){a[t]=new RegExp("(\\s|^)"+t+"(\\s|$)")}return a[t].test(e[$]("class")||"")&&a[t]},K=function(e,t){if(!J(e,t)){e.setAttribute("class",(e[$]("class")||"").trim()+" "+t)}},Q=function(e,t){var a;if(a=J(e,t)){e.setAttribute("class",(e[$]("class")||"").replace(a," "))}},V=function(t,a,e){var i=e?P:"removeEventListener";if(e){V(t,a)}r.forEach(function(e){t[i](e,a)})},X=function(e,t,a,i,r){var n=D.createEvent("Event");if(!a){a={}}a.instance=k;n.initEvent(t,!i,!r);n.detail=a;e.dispatchEvent(n);return n},Y=function(e,t){var a;if(!i&&(a=u.picturefill||H.pf)){if(t&&t.src&&!e[$]("srcset")){e.setAttribute("srcset",t.src)}a({reevaluate:true,elements:[e]})}else if(t&&t.src){e.src=t.src}},Z=function(e,t){return(getComputedStyle(e,null)||{})[t]},s=function(e,t,a){a=a||e.offsetWidth;while(a<H.minSize&&t&&!e._lazysizesWidth){a=t.offsetWidth;t=t.parentNode}return a},ee=function(){var a,i;var t=[];var r=[];var n=t;var s=function(){var e=n;n=t.length?r:t;a=true;i=false;while(e.length){e.shift()()}a=false};var e=function(e,t){if(a&&!t){e.apply(this,arguments)}else{n.push(e);if(!i){i=true;(D.hidden?I:U)(s)}}};e._lsFlush=s;return e}(),te=function(a,e){return e?function(){ee(a)}:function(){var e=this;var t=arguments;ee(function(){a.apply(e,t)})}},ae=function(e){var a;var i=0;var r=H.throttleDelay;var n=H.ricTimeout;var t=function(){a=false;i=f.now();e()};var s=o&&n>49?function(){o(t,{timeout:n});if(n!==H.ricTimeout){n=H.ricTimeout}}:te(function(){I(t)},true);return function(e){var t;if(e=e===true){n=33}if(a){return}a=true;t=r-(f.now()-i);if(t<0){t=0}if(e||t<9){s()}else{I(s,t)}}},ie=function(e){var t,a;var i=99;var r=function(){t=null;e()};var n=function(){var e=f.now()-a;if(e<i){I(n,i-e)}else{(o||r)(r)}};return function(){a=f.now();if(!t){t=I(n,i)}}},e=function(){var v,m,c,h,e;var y,z,g,p,C,b,A;var n=/^img$/i;var d=/^iframe$/i;var E="onscroll"in u&&!/(gle|ing)bot/.test(navigator.userAgent);var _=0;var w=0;var M=0;var N=-1;var L=function(e){M--;if(!e||M<0||!e.target){M=0}};var x=function(e){if(A==null){A=Z(D.body,"visibility")=="hidden"}return A||!(Z(e.parentNode,"visibility")=="hidden"&&Z(e,"visibility")=="hidden")};var W=function(e,t){var a;var i=e;var r=x(e);g-=t;b+=t;p-=t;C+=t;while(r&&(i=i.offsetParent)&&i!=D.body&&i!=O){r=(Z(i,"opacity")||1)>0;if(r&&Z(i,"overflow")!="visible"){a=i.getBoundingClientRect();r=C>a.left&&p<a.right&&b>a.top-1&&g<a.bottom+1}}return r};var t=function(){var e,t,a,i,r,n,s,o,l,u,f,c;var d=k.elements;if((h=H.loadMode)&&M<8&&(e=d.length)){t=0;N++;for(;t<e;t++){if(!d[t]||d[t]._lazyRace){continue}if(!E||k.prematureUnveil&&k.prematureUnveil(d[t])){R(d[t]);continue}if(!(o=d[t][$]("data-expand"))||!(n=o*1)){n=w}if(!u){u=!H.expand||H.expand<1?O.clientHeight>500&&O.clientWidth>500?500:370:H.expand;k._defEx=u;f=u*H.expFactor;c=H.hFac;A=null;if(w<f&&M<1&&N>2&&h>2&&!D.hidden){w=f;N=0}else if(h>1&&N>1&&M<6){w=u}else{w=_}}if(l!==n){y=innerWidth+n*c;z=innerHeight+n;s=n*-1;l=n}a=d[t].getBoundingClientRect();if((b=a.bottom)>=s&&(g=a.top)<=z&&(C=a.right)>=s*c&&(p=a.left)<=y&&(b||C||p||g)&&(H.loadHidden||x(d[t]))&&(m&&M<3&&!o&&(h<3||N<4)||W(d[t],n))){R(d[t]);r=true;if(M>9){break}}else if(!r&&m&&!i&&M<4&&N<4&&h>2&&(v[0]||H.preloadAfterLoad)&&(v[0]||!o&&(b||C||p||g||d[t][$](H.sizesAttr)!="auto"))){i=v[0]||d[t]}}if(i&&!r){R(i)}}};var a=ae(t);var S=function(e){var t=e.target;if(t._lazyCache){delete t._lazyCache;return}L(e);K(t,H.loadedClass);Q(t,H.loadingClass);V(t,B);X(t,"lazyloaded")};var i=te(S);var B=function(e){i({target:e.target})};var T=function(e,t){var a=e.getAttribute("data-load-mode")||H.iframeLoadMode;if(a==0){e.contentWindow.location.replace(t)}else if(a==1){e.src=t}};var F=function(e){var t;var a=e[$](H.srcsetAttr);if(t=H.customMedia[e[$]("data-media")||e[$]("media")]){e.setAttribute("media",t)}if(a){e.setAttribute("srcset",a)}};var s=te(function(t,e,a,i,r){var n,s,o,l,u,f;if(!(u=X(t,"lazybeforeunveil",e)).defaultPrevented){if(i){if(a){K(t,H.autosizesClass)}else{t.setAttribute("sizes",i)}}s=t[$](H.srcsetAttr);n=t[$](H.srcAttr);if(r){o=t.parentNode;l=o&&j.test(o.nodeName||"")}f=e.firesLoad||"src"in t&&(s||n||l);u={target:t};K(t,H.loadingClass);if(f){clearTimeout(c);c=I(L,2500);V(t,B,true)}if(l){G.call(o.getElementsByTagName("source"),F)}if(s){t.setAttribute("srcset",s)}else if(n&&!l){if(d.test(t.nodeName)){T(t,n)}else{t.src=n}}if(r&&(s||l)){Y(t,{src:n})}}if(t._lazyRace){delete t._lazyRace}Q(t,H.lazyClass);ee(function(){var e=t.complete&&t.naturalWidth>1;if(!f||e){if(e){K(t,H.fastLoadedClass)}S(u);t._lazyCache=true;I(function(){if("_lazyCache"in t){delete t._lazyCache}},9)}if(t.loading=="lazy"){M--}},true)});var R=function(e){if(e._lazyRace){return}var t;var a=n.test(e.nodeName);var i=a&&(e[$](H.sizesAttr)||e[$]("sizes"));var r=i=="auto";if((r||!m)&&a&&(e[$]("src")||e.srcset)&&!e.complete&&!J(e,H.errorClass)&&J(e,H.lazyClass)){return}t=X(e,"lazyunveilread").detail;if(r){re.updateElem(e,true,e.offsetWidth)}e._lazyRace=true;M++;s(e,t,r,i,a)};var r=ie(function(){H.loadMode=3;a()});var o=function(){if(H.loadMode==3){H.loadMode=2}r()};var l=function(){if(m){return}if(f.now()-e<999){I(l,999);return}m=true;H.loadMode=3;a();q("scroll",o,true)};return{_:function(){e=f.now();k.elements=D.getElementsByClassName(H.lazyClass);v=D.getElementsByClassName(H.lazyClass+" "+H.preloadClass);q("scroll",a,true);q("resize",a,true);q("pageshow",function(e){if(e.persisted){var t=D.querySelectorAll("."+H.loadingClass);if(t.length&&t.forEach){U(function(){t.forEach(function(e){if(e.complete){R(e)}})})}}});if(u.MutationObserver){new MutationObserver(a).observe(O,{childList:true,subtree:true,attributes:true})}else{O[P]("DOMNodeInserted",a,true);O[P]("DOMAttrModified",a,true);setInterval(a,999)}q("hashchange",a,true);["focus","mouseover","click","load","transitionend","animationend"].forEach(function(e){D[P](e,a,true)});if(/d$|^c/.test(D.readyState)){l()}else{q("load",l);D[P]("DOMContentLoaded",a);I(l,2e4)}if(k.elements.length){t();ee._lsFlush()}else{a()}},checkElems:a,unveil:R,_aLSL:o}}(),re=function(){var a;var n=te(function(e,t,a,i){var r,n,s;e._lazysizesWidth=i;i+="px";e.setAttribute("sizes",i);if(j.test(t.nodeName||"")){r=t.getElementsByTagName("source");for(n=0,s=r.length;n<s;n++){r[n].setAttribute("sizes",i)}}if(!a.detail.dataAttr){Y(e,a.detail)}});var i=function(e,t,a){var i;var r=e.parentNode;if(r){a=s(e,r,a);i=X(e,"lazybeforesizes",{width:a,dataAttr:!!t});if(!i.defaultPrevented){a=i.detail.width;if(a&&a!==e._lazysizesWidth){n(e,r,i,a)}}}};var e=function(){var e;var t=a.length;if(t){e=0;for(;e<t;e++){i(a[e])}}};var t=ie(e);return{_:function(){a=D.getElementsByClassName(H.autosizesClass);q("resize",t)},checkElems:t,updateElem:i}}(),t=function(){if(!t.i&&D.getElementsByClassName){t.i=true;re._();e._()}};return I(function(){H.init&&t()}),k={cfg:H,autoSizer:re,loader:e,init:t,uP:Y,aC:K,rC:Q,hC:J,fire:X,gW:s,rAF:ee}}(e,e.document,Date);e.lazySizes=t,"object"==typeof module&&module.exports&&(module.exports=t)}("undefined"!=typeof window?window:{})});
// Post Series Home
var update={mainItem:["Series"]};update.run=function(category,page,num){var start=(page-1)*num+1;var script=document.createElement("script");script.src="/feeds/posts/default/-/"+category+"?alt=json-in-script&orderby=published&start-index="+start+"&max-results="+num+"&callback=update.vutran";document.body.appendChild(script);};update.vutran=function(data){var entries=data.feed.entry;if(!entries)return;var total=data.feed.openSearch$totalResults.$t;var start=data.feed.openSearch$startIndex.$t;var num=data.feed.openSearch$itemsPerPage.$t;var mainItems=[];entries.forEach(function(entry){var title=entry.title.$t;var categories=entry.category.map(function(cat){return cat.term;});var link=entry.link.find(function(link){return link.rel==="alternate";}).href;var published=entry.published.$t;var thumbnail=entry.media$thumbnail?entry.media$thumbnail.url.replace("s72","w175-h235-rw"):imageString(entry.content.$t);if(update.mainItem.some(function(item){return categories.includes(item);})){var labelContent="";var labelElement=entry.content.$t.match(/<div id="getlabel">(.*?)<\/div>/i);if(labelElement){labelContent=labelElement[1];}
mainItems.push({title:title,link:link,thumbnail:thumbnail,categories:categories,labelContent:labelContent});}});var mainHTML="";mainItems.forEach(function(item){var statusClass={"Đang tiến hành":"in-progress-tranvu","Hoàn thành":"completed-tranvu","Drop":"drop-tranvu"};var categoryClass={Manga:"manga-tranvu",Manhwa:"manhwa-tranvu",Manhua:"manhua-tranvu","Light Novel":"Ln-tranvu","Web Novel":"Wn-tranvu"};var labelClass={Hot:"Hot-tranvu",New:"New-tranvu"};var categories=item.categories.flatMap(function(category){return[statusClass[category],categoryClass[category],labelClass[category]].filter(Boolean).map(function(className){return"<span class='"+className+"'></span>";});}).join("");var labelAttribute=item.labelContent?"label='"+item.labelContent+"'":"";mainHTML+="<div class='vuItem' "+labelAttribute+"><a href='"+item.link+"' title='Đọc ngay "+item.title+"'><div class='bookCover'><img class='lazyload' data-src='"+item.thumbnail+"' alt='"+item.title+"'>"+categories+"</div><div class='bookDetails'><h3><div class='titleSeries' alt='Đọc ngay "+item.title+"'>"+item.title+"</div></h3></div></a><ul class='Chapter-list'><span class='loaders'></span></ul></div>";});var paginationHTML="";if(total>num){var currentPage=Math.floor((start-1)/num)+1;var totalPages=Math.ceil(total/num);var firstPage=Math.max(1,currentPage-2);var lastPage=Math.min(totalPages,currentPage+2);var prevPage=currentPage-1;var nextPage=currentPage+1;paginationHTML+="<div class='pagination-vu'><ul>";if(currentPage>1){paginationHTML+="<li class='prev-vu'><a href='?page="+prevPage+"' title='Sang trang "+prevPage+"'><span>&laquo</span></a></li>";}
if(firstPage>1){paginationHTML+="<li><a href='?page=1' title='Trang 1'><span>1</span></a></li>";if(firstPage>2){paginationHTML+="<li class='disabled-vu'><span>...</span></li>";}}
for(var i=firstPage;i<=lastPage;i++){if(i===currentPage){paginationHTML+="<li class='active-vu'><span>"+i+"</span></li>";}else{paginationHTML+="<li><a href='?page="+i+"' title='Trang "+i+"'><span>"+i+"</span></a></li>";}}
if(lastPage<totalPages){if(lastPage<totalPages-1){paginationHTML+="<li class='disabled'><span>...</span></li>";}
paginationHTML+="<li><a href='?page="+totalPages+"' title='Trang "+totalPages+"'><span>"+totalPages+"</span></a></li>";}
if(currentPage<totalPages){paginationHTML+="<li class='next-vu'><a href='?page="+nextPage+"' title='Sang trang "+nextPage+"'><span>&raquo;</span></a></li>";}
paginationHTML+="</ul></div>";}
var mainnnv=document.getElementById("mainnnv");var phantrannnv=document.getElementById("phantrannnv");if(mainnnv)mainnnv.innerHTML=mainHTML;if(phantrannnv)phantrannnv.innerHTML=paginationHTML;};function imageString(str){var imgStart=str.indexOf("<img");if(imgStart===-1)return"";var srcStart=str.indexOf("src=\"",imgStart)+5;var srcEnd=str.indexOf("\"",srcStart);return str.slice(srcStart,srcEnd);}
var urlParams=new URLSearchParams(window.location.search);var page=urlParams.get('page')||1;window.addEventListener('DOMContentLoaded',function(){update.run("Series",parseInt(page),1)
const replacements=[{name:'Chapter',news:'Ch.'},{name:'Chương',news:'Ch.'},{name:'Quyển',news:'Q.'},{name:'Tập',news:'T.'},{name:'Đặc biệt',news:'Đ.Biệt'},{name:'ngoại truyện',news:'N.Truyện'},{name:'Ngoài lề',news:'N.Lề'}];function createChapterList(vuItem){const numchar=3;const validLabels=['chapter','novels'];const maxchar=numchar+3;const website=window.location.origin;const label=vuItem.getAttribute('label');const feedUrl=`${website}/feeds/posts/summary/-/${label}?max-results=${maxchar}`;const xhttp=new XMLHttpRequest();xhttp.onreadystatechange=function(){if(this.readyState===4&&this.status===200){const parser=new DOMParser();const responseXML=parser.parseFromString(this.responseText,'text/xml');const latestPostLink=responseXML.querySelector('link[rel="alternate"][type="text/html"]').getAttribute('href');const chapterList=vuItem.querySelector('.Chapter-list');chapterList.innerHTML='';const entries=responseXML.querySelectorAll('entry');const filteredEntries=Array.from(entries).filter(function(entry){const categories=entry.querySelectorAll('category');let hasValidLabel=false;categories.forEach(function(category){const term=category.getAttribute('term').toLowerCase();if(validLabels.includes(term)){hasValidLabel=true;}});return hasValidLabel;});filteredEntries.slice(0,numchar).forEach(function(entry){const title=entry.querySelector('title').textContent;let modifiedTitle=title;replacements.forEach(function(replacement){modifiedTitle=modifiedTitle.replace(new RegExp(replacement.name,'g'),replacement.news);});replacements.forEach(function(replacement){if(modifiedTitle.includes(replacement.news)){modifiedTitle=modifiedTitle.replace(new RegExp(`.*${replacement.news}(.*)$`),`${replacement.news}$1`)}});const listItem=document.createElement('li');const linkItem=document.createElement('a');const timeAgoItem=document.createElement('span');linkItem.href=new URL(entry.querySelector('link[rel="alternate"][type="text/html"]').getAttribute('href'),feedUrl).href;linkItem.textContent=modifiedTitle;timeAgoItem.textContent=getTimeAgo(entry.querySelector('published').textContent);listItem.appendChild(linkItem);listItem.appendChild(timeAgoItem);chapterList.appendChild(listItem);});}};xhttp.open('GET',feedUrl,true);xhttp.send();}
const vuItems=document.getElementsByClassName('vuItem');if(vuItems.length===0){const observer=new MutationObserver(function(mutations){mutations.forEach(function(mutation){if(mutation.addedNodes.length>0){const addedNodes=mutation.addedNodes;addedNodes.forEach(function(node){if(node.classList&&node.classList.contains('vuItem')){observer.disconnect();createChapterList(node);}});}});});observer.observe(document.body,{childList:true,subtree:true});}else{Array.from(vuItems).forEach(function(vuItem){createChapterList(vuItem);});}
function getTimeAgo(dateString){const date=new Date(dateString);const now=new Date();const seconds=Math.floor((now-date)/1000);if(seconds<60){return seconds+' giây trước';}else if(seconds<3600){const minutes=Math.floor(seconds/60);return minutes+' phút trước';}else if(seconds<86400){const hours=Math.floor(seconds/3600);return hours+' giờ trước';}else if(seconds<604800){const days=Math.floor(seconds/86400);return days+' ngày trước';}else if(seconds<2629746){const weeks=Math.floor(seconds/604800);return weeks+' tuần trước';}else if(seconds<31556952){const months=Math.floor(seconds/2629746);return months+' tháng trước';}else{const years=Math.floor(seconds/31556952);return years+' năm trước';}}
var mainnnv=document.getElementById("mainnnv");var observer=new MutationObserver(function(mutations,observer){if(mutations.some(mutation=>mutation.addedNodes.length>0)){observer.disconnect();mainnnv.style.display="";document.getElementById("phantrannnv").style.display="";document.querySelector(".lzozazdziznzg").style.display="none";}});observer.observe(mainnnv,{childList:true});});
// Multi Tab PopularPost
window.addEventListener("DOMContentLoaded",function(){$(document).ready(function(){$(".tabx span").click(function(){var a=$(this).attr("data-tab");$(".tabx span").removeClass("active");$(".PopularPosts").removeClass("current");$(this).addClass("active");$("#"+a).addClass("current")})})});
// Slider Home
function getFirstParagraph(html){var tmp=document.createElement("div");tmp.innerHTML=html;var textx2Content=tmp.querySelector("#noidung")?.textContent||"Không có mô tả...";return textx2Content;}
function postarea4(data){var j,maxpost;j=showRandomImg?Math.floor((imgr.length+1)*Math.random()):0;var img=[];postnum4<=data.feed.entry.length?(maxpost=postnum5):(maxpost=data.feed.entry.length);var owlCarouselDiv=document.querySelector(".owl-carousel");var html="";var t=data.feed.entry;for(var i=0;i<maxpost;i++){var n=t[i];var l=n.title.$t;var o='<div class="site-ret"><span class="fa fa-star" aria-hidden="true"><span>'+data.feed.entry[i].category[0].term+"</div>";var p="";for(var sx=0;sx<n.category.length;sx++){if("Manga"==n.category[sx].term){p='<span class="type-poss">Manga</span>';}else if("Manhua"==n.category[sx].term){p='<span class="type-poss">Manhua</span>';}else if("Komik"==n.category[sx].term){p='<span class="type-poss">Komik</span>';}else if("Manhwa"==n.category[sx].term){p='<span class="type-poss">Manhwa</span>';}else if("Webtoon"==n.category[sx].term){p='<span class="type-poss">Webtoon</span>';}else if("Light Novel"==n.category[sx].term){p='<span class="type-poss">Light novel</span>';}}
var m="";for(var stt=0;stt<n.category.length;stt++){if("Hoàn thành"==n.category[stt].term){m='<span class="statusht"></span>';}else if("Đang tiến hành"==n.category[stt].term){m='<span class="statusdth"></span>';}else if("Drop"==n.category[stt].term){m='<span class="statusdrop"></span>';}}
var g="";for(var f=0;f<n.category.length;f++){g+='<a class="label label-slider" href="/search/label/'+n.category[f].term+'">'+n.category[f].term+"</a>";}
if(i==data.feed.entry.length){break;}
var r="",replies="";for(var v=0;v<n.link.length;v++){if("alternate"==n.link[v].rel){r=n.link[v].href;break;}}
for(var v=0;v<n.link.length;v++){if("replies"==n.link[v].rel&&"text/html"==n.link[v].type){replies=n.link[v].title.split(" ")[0];break;}}
var u="content"in n?n.content.$t:"summary"in n?n.summary.$t:"";if(u.length<200){break;}
var h=u.substring(0,200);var lastSpaceIndex=h.lastIndexOf(" ");h=h.substring(0,lastSpaceIndex);var postdate=n.published.$t;j>imgr.length-1&&(j=0);img[i]="";var s=u;var a=s.indexOf("<img");var b=s.indexOf('src="',a);var x=s.indexOf('"',b+5);var d=s.substr(b+5,x-b-5);var S="";if(data.feed.entry[i].media$thumbnail){S=data.feed.entry[i].media$thumbnail.url;S=S.replace("/s72-c/","/s300-rw/");}
var M=getFirstParagraph(u);var I='<a aria-label="Hình ảnh" href="'+r+'" class="slider-image" style="background:url('+S+') no-repeat center center;background-size: cover; display:block;box-shadow: 0 0 10px rgba(0,0,0,50);"/>';var getLabelDiv=n.content.$t;var labelContent="";var labelStartIndex=getLabelDiv.indexOf('<div id="getlabel">');var labelEndIndex=getLabelDiv.indexOf('</div>',labelStartIndex);if(labelStartIndex!==-1&&labelEndIndex!==-1){labelStartIndex+='<div id="getlabel">'.length;labelContent=getLabelDiv.substring(labelStartIndex,labelEndIndex);}
var C='<div class="slider-item getchapter" sliderlabelchapter="'+labelContent+'"><div class="slider-wrapp"><div class="thumb overlay">'+I+'</div><div class="owl-controls"><div class="owl-page active"></div><div class="owl-page"></div><div class="owl-page"></div><div class="owl-page"></div></div><div class="covert">'+I+m+'</div><div class="post-descript"><div class="post-title"><div class="right-title"><div class="post-titlenya"><a href="'+r+'">'+l+'</a></div><div class="post-tag">'+p+'</div></div><div class="post-meta"><div class="post-tr">'+o+'</div></div></div><div class="post-genre"><div class="genre-slide">'+g+'</div></div><div class="post-sinop"><p>'+M+'</p></div> <div class="chapterandinfo"><div class="chapterlist"></div><div class="infoSeriesS"><a class="infoSeries" href="'+r+'">Thông tin truyện</a></div></div> </div><div class="clear"></div></div></div>';html+=C;j++;}
owlCarouselDiv.innerHTML=html;$(".owl-carousel").owlCarousel({autoplay:true,loop:true,lazyLoad:true,nav:true,dots:true,video:true,navText:["<i class='fa fa-angle-left'></i>","<i class='fa fa-angle-right'></i>"],smartSpeed:500,responsiveClass:true,responsive:{0:{items:1},600:{items:1},1000:{items:1}}});}
var cat1="Featured";var imgr=[];imgr[0]="http://3.bp.blogspot.com/-zP87C2q9yog/UVopoHY30SI/AAAAAAAAE5k/AIyPvrpGLn8/s1600/picture_not_available.png";var showRandomImg=true;var aBold=true;var summaryPost=150;var summaryTitle=50;var postnum1=1;var postnum4=8;var postnum5=8;var feedUrl="/feeds/posts/default/-/Series";function jsonpCallback(data){postarea4(data);}
window.addEventListener('load',function(){var script=document.createElement("script");script.src=feedUrl+"?alt=json-in-script&max-results=5&callback=jsonpCallback";document.body.appendChild(script);function createChapterListCustom(getchapter,labelCustom){const numcharCustom=1;const validLabelsCustom=['chapter','novels'];const maxcharCustom=numcharCustom+3;const websiteCustom=window.location.origin;const feedUrlCustom=`${websiteCustom}/feeds/posts/summary/-/${labelCustom}?max-results=${maxcharCustom}`;const xhttpCustom=new XMLHttpRequest();xhttpCustom.onreadystatechange=function(){if(this.readyState===4&&this.status===200){const parser=new DOMParser();const responseXML=parser.parseFromString(this.responseText,'text/xml');const entries=responseXML.querySelectorAll('entry');const filteredEntries=Array.from(entries).filter(function(entry){const categories=entry.querySelectorAll('category');let hasValidLabel=false;categories.forEach(function(category){const term=category.getAttribute('term').toLowerCase();if(validLabelsCustom.includes(term)){hasValidLabel=true;}});return hasValidLabel;});const chapterContainer=getchapter.querySelector('.chapterlist');if(chapterContainer){chapterContainer.innerHTML='';filteredEntries.slice(0,numcharCustom).forEach(function(entry){const title=entry.querySelector('title').textContent;const link=new URL(entry.querySelector('link[rel="alternate"][type="text/html"]').getAttribute('href'),feedUrlCustom).href;const linkItem=document.createElement('a');linkItem.href=link;linkItem.textContent=title;chapterContainer.appendChild(linkItem);});}}};xhttpCustom.open('GET',feedUrlCustom,true);xhttpCustom.send();}
function observeChapterLists(){const chapterLists=document.getElementsByClassName('chapterlist');Array.from(chapterLists).forEach(function(chapterList){if(chapterList.children.length===0){const parentGetChapter=chapterList.closest('.getchapter');if(parentGetChapter){const labelCustom=parentGetChapter.getAttribute('sliderlabelchapter');createChapterListCustom(parentGetChapter,labelCustom);}}});}
const observer=new MutationObserver(function(mutations){mutations.forEach(function(mutation){if(mutation.addedNodes.length>0){observeChapterLists();}});});observer.observe(document.body,{childList:true,subtree:true});document.addEventListener('DOMContentLoaded',function(){observeChapterLists()})});
// Lượt xem
window.addEventListener('load', function() {$(function(){jQuery.getScript("//cdn.firebase.com/v0/firebase.js").done(function(){$.each($(".post-views"),function(e,t){var a=$(t).find("#postviews"),n=$('link[rel="canonical"]').attr("href"),i=$(t).attr("data-id"),o=new Firebase("https://mskmanga-default-rtdb.firebaseio.com/Pages/"+i);o.once("value",function(e){var t,l=e.val(),c=!1;null==l&&((l={}).value=0,l.url=n,l.id=i,c=!0),a.text((t=l.value,t>=1e9?(t/1e9).toFixed(1)+" Tỷ":t>=1e6?(t/1e6).toFixed(1)+"Tr":t>=1e3?(t/1e3).toFixed(1)+"K":t)),l.value++,"/"!=window.location.pathname&&n==l.url&&(c?o.set(l):o.child("value").set(l.value))})})})})});
